<!doctype html>
<html lang="en" ng-app="businessDirectory">
<head>
  <meta charset="utf-8">
  <title>Business Directory</title>
  <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../components/angular-ui/build/angular-ui.min.css">
  <link rel="stylesheet" href="style.css">
</head>
<body data-ng-controller="MainCtrl">
<div class="container">

  <div data-resource-loading-notification></div>

  <div data-ng-controller="MainMapCtrl" class="mainMap-wrapper">
    <div id="map_canvas" class="mainMap"
        ui-map="map" ui-map-marker="markers"
        ui-event="{'map-idle': mapLoaded()}"
        ui-options="getMapOptions()">
    </div>

    <div class="well clearfix">
      <ul class="categories">
        <li data-ng-repeat="category in categories">
          <label class="checkbox">
            <input type="checkbox" value="{{$index}}"
                data-ng-model="activeCategories[$index]"
                data-ng-click="filterChanged($index)">
            {{category}}
          </label>
        </li>
      </ul>
    </div>
  </div>

  <div style="clear: both"></div>

  <div data-ng-controller="BusinessListCtrl">

    <div id="searchHeader" class="form-inline tac">
      <h2>Search for businesses near you</h2>
      <label>Filter By Type:
        <select data-ng-options="value for value in categories"
            data-ng-model="search.category"></select>
      </label>
      <label>Search By Name:
        <input type="search" data-ng-model="search.query">
      </label>
    </div>

    <div id="searchResults">
      <ul class="media-block">
        <li class="span6 media-block-module" data-ng-repeat="business in businesses | filter:{$: search.query, category: search.category}">

          <div class="media-story">

            <h3 class="item-title">
              <a data-ng-show="isLink(business.website)" data-ng-href="http://{{business.website}}" data-ng-bind="business.business_name" target="_blank"></a>
              <span data-ng-hide="isLink(business.website)" data-ng-bind="business.business_name"></span>
            </h3>

            <ul class="media-content">
              <li class="address">
                <a data-ng-href="https://maps.google.com/?mid=1339090648&amp;q={{ buildAddress(business) }}"
                    data-ng-bind="buildAddress(business)"></a>
              </li>
              <li class="phone">
                <phone data-ng-bind="business.phone"></phone>
              </li>
              <li class="type" data-ng-bind="business.category"></li>
              <li class="socials">
                <a data-ng-show="business.google_place_url" data-ng-href="{{business.google_place_url}}">Google Place</a>
                <a data-ng-show="business.facebook_url" data-ng-href="{{business.facebook_url}}">Facebook</a>
                <a data-ng-show="business.yelp_url" data-ng-href="{{business.yelp_url}}">Yelp</a>
              </li>
            </ul>

            <!-- Individual item map -->
            <div data-ng-switch="isMapEnabled(business)">
              <div class="tar">
                <a href="#show-map"
                    data-ng-show="businessDataSpace(business, 'map').isMapHidden"
                    data-ng-click="showMap(business, $event)">Show map <i class="icon-arrow-down"></i></a>
                <a href="#show-map"
                    data-ng-hide="businessDataSpace(business, 'map').isMapHidden"
                    data-ng-click="hideMap(business, $event)">Hide map <i class="icon-arrow-up"></i></a>
              </div>
              <div data-ng-switch-when="true" data-ng-hide="businessDataSpace(business, 'map').isMapHidden">
                <div id="map_canvas_individual" class="map"
                    ui-map="businessDataSpace(business, 'map').map"
                    ui-event="{'map-idle': mapLoaded(business)}"
                    ui-options="getMapOptions(business)">
                </div>
              </div>
            </div>

          </div>
        </li>
      </ul>
    </div>

  </div>
</div>

<!-- Scripts -->
<script src="../components/underscore/underscore-min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.0.6/angular.min.js"></script>
<script src="../components/angular-ui/build/angular-ui.min.js"></script>

<script src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>

<script src="../js/business-directory/app.js"></script>
<script src="../js/business-directory/config.js"></script>
<script src="../js/business-directory/services.js"></script>
<script src="../js/business-directory/controllers.js"></script>
<script src="../js/business-directory/filters.js"></script>
<script src="../js/business-directory/directives.js"></script>
</body>
</html>
